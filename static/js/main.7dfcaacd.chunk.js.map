{"version":3,"sources":["components/MainVizComponent/MainVizComponent.js","VizHelpers.js","App.js","DataLoading.js","serviceWorker.js","index.js","data/gnpc_commodity_exports.csv","logo.svg"],"names":["MainVizComponent","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","createChart","bind","assertThisInitialized","state","height","setState","data","length","nextProps","_this$props","revAsCircles","timeline","margin","top","right","bottom","left","width","node","select","console","log","_","sortBy","forEach","d","yRevBottom","yRevTop","numFormat","format","yTimeLine","scaleLinear","range","yIndex","config","xOffset","yOffset","labelPositioning","alpha","spacing","leftTitle","rightTitle1","rightTitle2","leftSubTitle","rightSubTitle","labelGroupOffset","labelKeyOffset","radius","subTitleYShift","unfocusOpacity","revWidthMultiple","priceWidthMultiple","timelineWidthMultiple","smallConfig","maxwidth","color","highlightColor","border","volWidth","revBoxesPerCol","maxRevWidth","volTitle","priceTitle1","priceTitle2","revTitle1","revTitle2","tooltip","tip","attr","offset","direction","html","title","items","htmlBlock","i","label","value","makeTooltip","year","Lifting","Date_of_sale","Payment_receipt_date","Price","Volume","Revenue","Buyer","Destination","selectAll","remove","scaleSequential","interpolateReds","domain","getY","yVal","index","maxDate","moment","map","toDate","minDate","add","subtract","borderLines","append","slopeGroups","enter","id","sellDate","paymentDate","leftSlopeLabels","each","xLeftPosition","yLeftPosition","text","rightSlopeLabels","xRightPosition","yRightPosition","titles","priceBars","smallX","maxRev","max","circleX","Math","sqrt","makeClass","split","join","toLowerCase","volBars","revBars","on","show","hide","push","volData","round","currentBatch","j","boxWidth","floor","returnVal","defaultX","defaultY","vCumulativeDelta","_this2","react_default","a","createElement","className","ref","Component","defaultProps","App","objectSpread","dimensions","window","innerWidth","innerHeight","handleTimeLineChange","handleFilterYearChange","handleRevAsCirclesChange","updateDimensions","addEventListener","getData","checked","filteredData","filter","promises","csv","timorAll","Promise","all","then","values","result","loadAllData","years","concat","toConsumableArray","uniq","isEmpty","Helmet","charSet","name","content","react_switch_default","onChange","lib","defaultValue","components_MainVizComponent_MainVizComponent","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister","module","exports","__webpack_require__","p"],"mappings":"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","file":"static/js/main.7dfcaacd.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport styles from './MainVizComponent.scss'\nimport _ from 'lodash'\nimport { select, selectAll } from 'd3-selection'\nimport { scaleBand,scaleLinear,scaleQuantile,scaleSequential } from 'd3-scale'\nimport { interpolateReds } from 'd3-scale-chromatic'\nimport { axisBottom, axisLeft } from 'd3-axis'\nimport { format } from 'd3-format'\nimport { default as tip } from 'd3-tip'\nimport { min, max } from 'd3-array'\nimport { makeTooltip } from '../../VizHelpers'\nimport * as moment from 'moment'\n\n\n\nclass MainVizComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n    this.createChart = this.createChart.bind(this)\n    this.state = {\n      height: 4000\n    }\n\t}\n\tcomponentDidMount() {\n    this.setState({\n      height: this.props.data.length * 180\n    })\n\t\tthis.createChart()\n\t}\n\t\n\tcomponentDidUpdate() {\n\t\tthis.createChart()\n  }\n  \n  componentWillReceiveProps(nextProps) {\n    if (nextProps.data !== this.props.data) {\n      this.setState({\n        height: nextProps.data.length * 180\n      })\n    }\n  }\n\n\tcreateChart() {\n\t\tlet data = this.props.data ? this.props.data : [];\n    // let timeline = this.props.timeline;\n    let {revAsCircles, timeline} = this.props;\n\t\tvar margin = {top: 150, right: 5, bottom: 5, left: this.props.width/3 },\n\t\twidth = this.props.width - margin.left - margin.right,\n\t\theight = this.state.height - margin.top - margin.bottom,\n\t\tnode = select(this.node);\n\n\t\tconsole.log(data);\n\t\tconsole.log(revAsCircles);\n\n\t\tdata = _.sortBy(data,\"Date_of_sale\")\n    // const barHeight = 5;\n    data.forEach(d => {\n      d.yRevBottom = 0;\n      d.yRevTop = 0;\n    })\n\n\t\t// var durationFormat = format(\".1f\");\n\t\tvar numFormat = format(',.2f');\n\n\t\tvar yTimeLine = scaleLinear()\n      .range([height, 0]);\n      \n    var yIndex = scaleLinear()\n    \t.range([height, 0]);\n\n\t\tvar config = {\n      xOffset: 0,\n      yOffset: 0,\n      // width: 150,\n      width: width/8,\n      height: height,\n      labelPositioning: {\n        alpha: 0.5,\n        spacing: 18\n      },\n      leftTitle: \"Lifting\",\n      rightTitle1: \"Buyer\",\n      rightTitle2: \"& Destination\",\n      leftSubTitle: \"Date of Sale\",\n      rightSubTitle: \"Payment Due Date\",\n      labelGroupOffset: 5,\n      labelKeyOffset: 50,\n\t\t\tradius: 6,\n\t\t\tsubTitleYShift: 20,\n      // Reduce this to turn on detail-on-hover version\n\t\t\tunfocusOpacity: 0.3,\n\t\t\trevWidthMultiple: 3.5,\n      priceWidthMultiple: 1.5,\n      timelineWidthMultiple: 0.6\n\t\t}\n\t\t\n\t\tvar smallConfig = {\n\t\t\tmaxwidth: width/15 > 20 ? width/15 : 20,\n\t\t\theight: 10,\n\t\t\t// color: '#c59800',\n\t\t\tcolor: '#ecb600',\n\t\t\thighlightColor: '#CE1126',\n\t\t\tborder: '#eee',\n      volWidth: 2.5,\n      revBoxesPerCol: 10,\n\t\t\tmaxRevWidth: 400,\n\t\t\tvolTitle: \"Volume (barrels)\",\n\t\t\tpriceTitle1: \"Price\",\n\t\t\tpriceTitle2: \"(US$)\",\n\t\t\trevTitle1: \"Revenue\",\n\t\t\trevTitle2: \"(US$)\",\n\t\t}\n\n\t\tlet tooltip = tip()\n\t\t\t.attr('class', 'd3-tip')\n\t\t\t.offset([0, 20])\n\t\t\t.direction(d => revAsCircles ? 'e':'se')\n\t\t\t.html((d) => {\n\t\t\t\treturn makeTooltip(\n\t\t\t\t\td.year,\n\t\t\t\t\t[\n\t\t\t\t\t\t{label:\"Lifting\", value:d.Lifting},\n\t\t\t\t\t\t{label:\"Date of Sale\", value:d.Date_of_sale.format(\"D MMM YYYY\")},\n\t\t\t\t\t\t{label:\"Payment Receipt Date\", value:d.Payment_receipt_date.format(\"D MMM YYYY\")},\n\t\t\t\t\t\t{label:\"Price\", value:\"US$ \"+numFormat(d.Price)+\" per barrel\"},\n\t\t\t\t\t\t{label:\"Volume\", value:numFormat(d.Volume)+\" barrels\"},\n\t\t\t\t\t\t{label:\"Revenue\", value:\"US$ \"+numFormat(d.Revenue)},\n\t\t\t\t\t\t{label:\"Buyer\", value:d.Buyer},\n\t\t\t\t\t\t{label:\"Destination\", value:d.Destination}\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t})\n\n\t\tnode.selectAll(\"g\").remove();\n\n\t\tvar colorScale = scaleSequential(interpolateReds)\n\t\t.domain([0,10])\n\n\t\tvar getColor = function(cpue) {\n\t\t\tif (cpue) {\n\t\t\t\treturn colorScale(cpue);\n\t\t\t} else return \"#ccc\";\n    }\n    \n    var getY = function(yVal,index) {\n      if (timeline) {\n        return yTimeLine(yVal);\n      } else {\n        return yIndex(index);\n      }\n    }\n\n\t\t\t \n    // Calculate y domain for ratios\n    var maxDate = moment(moment.max(data.map(d => d.Payment_receipt_date)).toDate());\n    var minDate = moment(moment.min(data.map(d => d.Date_of_sale)).toDate());\n\n\t\tyTimeLine.domain([maxDate.add(2, 'months').toDate(), minDate.subtract(1, 'months').toDate()]);\n\t\tyIndex.domain([data.length, -1]);\n\t\t\n\t\t\t\t\n\t\tvar borderLines = node.append(\"g\")\n\t\t\t\t.attr(\"class\", \"border-lines\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\t\tborderLines.append(\"line\")\n\t\t\t.attr(\"x1\", 0).attr(\"y1\", 0)\n\t\t\t.attr(\"x2\", 0).attr(\"y2\", config.height);\n\t\tborderLines.append(\"line\")\n\t\t\t.attr(\"x1\", config.width*config.timelineWidthMultiple ).attr(\"y1\", 0)\n\t\t\t.attr(\"x2\", config.width*config.timelineWidthMultiple ).attr(\"y2\", config.height);\n\t\t\n\t\tvar slopeGroups = node.append(\"g\")\n\t\t\t.selectAll(\"g\")\n\t\t\t.data(data)\n\t\t\t.enter().append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", \"slope-group\")\n\t\t\t\t.attr(\"id\", function(d, i) {\n\t\t\t\t\td.id = \"group\" + d.Lifting;\n\t\t\t\t\td.sellDate = d.Date_of_sale.toDate();\n\t\t\t\t\td.paymentDate = d.Payment_receipt_date.toDate();\n\t\t\t\t});\n\t\t\n\t\tvar slopeLines = slopeGroups.append(\"line\")\n\t\t\t.attr(\"class\", \"slope-line\")\n\t\t\t.attr(\"x1\", 0)\n\t\t\t.attr(\"y1\", function(d,i) {\n\t\t\t\treturn getY(d.sellDate,i);\n\t\t\t})\n\t\t\t.attr(\"x2\", config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"y2\", function(d,i) {\n\t\t\t\treturn getY(d.paymentDate,i);\n\t\t\t});\n\t\t\n\t\tvar leftSlopeCircle = slopeGroups.append(\"circle\")\n      .attr(\"class\", function(d) { return \"circle\";})\n\t\t\t.attr(\"r\", config.radius)\n\t\t\t.attr(\"cy\", function(d,i) { return getY(d.sellDate,i);});\n\t\t\n\t\tvar leftSlopeLabels = slopeGroups.append(\"g\")\n\t\t\t.attr(\"class\", \"slope-label-left\")\n\t\t\t.each(function(d,i) {\n\t\t\t\td.xLeftPosition = -config.labelGroupOffset;\n\t\t\t\td.yLeftPosition = getY(d.sellDate,i);\n\t\t\t});\n\t\t\n\t\tleftSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", d => d.xLeftPosition)\n\t\t\t.attr(\"y\", d => d.yLeftPosition)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.text(d => (d.Date_of_sale.format(\"D MMM YYYY\")));\n\t\t\n\t\tleftSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xLeftPosition)\n\t\t\t.attr(\"y\", d => d.yLeftPosition)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", 3)\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.text(d => d.Lifting);\n\t\t\n    var rightSlopeCircle = slopeGroups.append(\"circle\")\n      .attr(\"class\", function(d) { return \"circle\";})\n    \t.attr(\"r\", config.radius)\n\t\t\t.attr(\"cx\", config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"cy\", function(d,i) { return getY(d.paymentDate,i);});\n\t\t\n\t\tvar rightSlopeLabels = slopeGroups.append(\"g\")\n\t\t\t.attr(\"class\", \"slope-label-right\")\n\t\t\t.each(function(d,i) {\n\t\t\t\td.xRightPosition = config.width*config.timelineWidthMultiple + config.labelGroupOffset;\n\t\t\t\td.yRightPosition = getY(d.paymentDate,i);\n\t\t\t});\n\t\t\n\t\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 2*config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.text(d => (d.Payment_receipt_date.format(\"D MMM YYYY\")));\n\t\t\n\t\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 3)\n\t\t\t.attr(\"text-anchor\", \"start\")\n      .text(d => d.Buyer);\n      \n    rightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 3+config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.text(d => d.Destination);\n      \n\t\tvar titles = node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", \"title\");\n      \n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"x\", margin.left)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(config.leftTitle);\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", margin.left)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t\t.text(config.leftSubTitle);\n\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n      .text(config.rightTitle1);\n    titles.append(\"text\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t\t.text(config.rightTitle2);\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + 2*config.subTitleYShift)\n\t\t\t.text(config.rightSubTitle);\n\n\n\n\t\tvar priceBars = node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width) + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", \"price\");\n\n\t\tvar smallX = scaleLinear()\n\t\t\t.range([0, smallConfig.maxwidth])\n      .domain([0,100]); \n      \n    var maxRev = max(data.map(d => d.Revenue))\n    var circleX = scaleLinear()\n\t\t\t.range([0, config.width])\n\t\t\t.domain([0,Math.sqrt(maxRev)]); \n\n\t\tfunction makeClass(d) {\n\t\t\treturn d.Lifting.split(\" \").join(\"\").toLowerCase();\n\t\t} \n\n    var volBars = [];\n\t\tvar revBars = [];\n\t\tvar annotations = [];\n\n\t\tpriceBars.selectAll(\".bar\")\n      .data(data)\n    .enter().append(\"rect\")\n      .attr(\"class\", function(d) { return \"bar price \" + makeClass(d);})\n      .attr(\"x\", function(d) { return config.width*config.priceWidthMultiple; })\n      .attr(\"width\", function(d) { return smallX(+d.Price) })\n      .attr(\"y\", function(d,i) { return d.yRightPosition - smallConfig.height/2; })\n      .attr(\"fill\", function(d) { return smallConfig.color; })\n      .attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t.on('mouseover', function(d) {\n        tooltip.show(d,this);\n        selectAll(\".\"+makeClass(d))\n\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\t\n\t\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t})\n\t\t\t.on('mouseout', function(d) {\n        tooltip.hide();\n        selectAll(\".\"+makeClass(d))\n\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\t\n\t\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t\t.attr(\"display\", \"none\")\n      })\n\n      if (revAsCircles) {\n        revBars.push(node.append(\"g\")\n          .attr(\"transform\", \"translate(\" + (margin.left + config.width*config.revWidthMultiple) + \",\" + margin.top + \")\")\n          .attr(\"class\", function(d) { return \"rev\";}));\n          \n        revBars[0].selectAll(\".bar\")\n          .data(data)\n        .enter().append(\"circle\")\n          .attr(\"class\", function(d) { return \"bar rev \" + makeClass(d);})\n          .attr(\"cx\", function(d) { \n            return config.width;\n          })\n          .attr(\"r\", function(d) { return circleX(Math.sqrt(+d.Revenue)) })\n          .attr(\"cy\", function(d) { \n\n            var returnVal = d.yRightPosition;\n            \n            return returnVal; \n          })\n          .attr(\"fill\", function(d) { return smallConfig.color; })\n          .attr(\"stroke\", function(d) { return smallConfig.border; })\n          // .attr(\"height\", function(d) { return smallConfig.height; })\n          .on('mouseover', function(d) {\n            tooltip.show(d,this);\n            selectAll(\".\"+makeClass(d))\n              .attr(\"fill\", smallConfig.highlightColor);\n            selectAll(\".annote.\"+ makeClass(d))\n              .attr(\"display\", \"block\")\n          })\n          .on('mouseout', function(d) {\n            tooltip.hide();\n            selectAll(\".\"+makeClass(d))\n              .attr(\"fill\", smallConfig.color);\n            selectAll(\".annote.\"+ makeClass(d))\n              .attr(\"display\", \"none\")\n          })\n      } \n\t\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1))\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.priceTitle1);\n    titles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n      .attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1))\n      .attr(\"dx\", -10)\n      .attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n      .text(smallConfig.priceTitle2);\n\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"dx\", 0)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.volTitle);\n\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.revWidthMultiple)\n\t\t\t.attr(\"dx\", 0)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.revTitle1);\n    titles.append(\"text\")\n      .attr(\"x\", margin.left + config.width*config.revWidthMultiple)\n      .attr(\"dx\", 0)\n      .attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n      .text(smallConfig.revTitle2);\n\n\t\tvar volData = data.map(function(d) {\n\t\t\treturn _.range(0,Math.round(d.Volume/10000))\n\t\t})\n\n\n\t\tconsole.log(volData);\n\n\t\t\n\t\tdata.forEach(function(currentBatch,i) {\n\t\t\tvolBars.push(node.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 10 + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", function(d) { return \"volume\";}))\n\n\t\t\trevBars.push(node.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width*config.revWidthMultiple) + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", function(d) { return \"rev\";}));\n\n\t\t\t// console.log(volBars);\n\n\t\t\tvolBars[i].selectAll(\".bar\")\n\t\t\t\t.data(volData[i])\n\t\t\t.enter().append(\"rect\")\n\t\t\t.attr(\"class\", function(d) { return \"bar vol \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", function(d,j) { return smallConfig.volWidth*j; })\n\t\t\t\t.attr(\"width\", function(d) { return smallConfig.volWidth })\n\t\t\t\t.attr(\"y\", function(d,j) { return currentBatch.yLeftPosition - smallConfig.height/2; })\n\t\t\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\ttooltip.show(currentBatch,this);\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\t\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function(d) {\n\t\t\t\t\ttooltip.hide();\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\t\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t})\n\n      if (!revAsCircles) {\n        revBars[i].selectAll(\".bar\")\n          .data(volData[i])\n        .enter().append(\"rect\")\n          .attr(\"class\", function(d) { return \"bar rev \" + makeClass(currentBatch);})\n          .attr(\"x\", function(d,j) { \n            var boxWidth = smallX(+currentBatch.Price)\n            // var boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n            var index = Math.floor(j / smallConfig.revBoxesPerCol);\n            return index*boxWidth;\n            \n\n          })\n          .attr(\"width\", function(d) { return smallX(+currentBatch.Price) })\n          .attr(\"y\", function(d,j) { \n            // var boxWidth = smallX(+currentBatch.Price)\n            // var boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n            // var row = Math.floor(j/boxesPerRow);\n\n            // data[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height \n            // \t? data[i].yRevBottom\n            // \t: returnVal + smallConfig.height;\n            \n            var index = j % smallConfig.revBoxesPerCol;\n            var returnVal = currentBatch.yRightPosition - smallConfig.height/2 + (smallConfig.height*index);\n            \n            data[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height \n              ? data[i].yRevBottom\n              : returnVal + smallConfig.height;\n            \n            return returnVal; \n          })\n          .attr(\"fill\", function(d) { return smallConfig.color; })\n          .attr(\"stroke\", function(d) { return smallConfig.border; })\n          .attr(\"height\", function(d) { return smallConfig.height; })\n          .on('mouseover', function(d) {\n            tooltip.show(currentBatch,this);\n            selectAll(\".\"+makeClass(currentBatch))\n              .attr(\"fill\", smallConfig.highlightColor);\n            selectAll(\".annote.\"+ makeClass(currentBatch))\n              .attr(\"display\", \"block\")\n          })\n          .on('mouseout', function(d) {\n            tooltip.hide();\n            selectAll(\".\"+makeClass(currentBatch))\n              .attr(\"fill\", smallConfig.color);\n            selectAll(\".annote.\"+ makeClass(currentBatch))\n              .attr(\"display\", \"none\")\n          })\n      }\n\t\t\t\n\n\t\t\t// Volume Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"left\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote vol \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", 10)\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t.attr(\"y\", currentBatch.yLeftPosition - 10)\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(numFormat(currentBatch.Volume)+\" barrels\")\n\n\t\t\t// Price Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote price \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1.25))\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t.attr(\"y\", currentBatch.yRightPosition)\n\t\t\t\t.attr(\"dy\", -10)\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(\"US$ \"+numFormat(currentBatch.Price)+\" per barrel\")\n\n\t\t\t// Revenue Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"left\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote rev \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", function() {\n          var defaultX = margin.left + config.width*(config.revWidthMultiple+.5);\n          return revAsCircles ? defaultX - config.width: defaultX;\n        })\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t// .attr(\"y\", currentBatch.yRightPosition - 10)\n\t\t\t\t.attr(\"y\", function(d) { \n          data[i].yRevTop = currentBatch.yRightPosition - 30;\n          var defaultY = currentBatch.yRightPosition-10;\n          return revAsCircles ? defaultY - config.width : defaultY;\n\t\t\t\t})\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(\"US$ \"+numFormat(currentBatch.Revenue) + \" in revenue \") \n\t\t\t\t\t// + numFormat(data[i].yRevTop) + \" \" + numFormat(data[i].yRevBottom) )\n\t\t\t\n\t\t})\n\n\t\tconsole.log(data);\n\n\t\t// Adjust Rev Blocks so they don't overlap\n\t\t// Start from the bottom and keep pushing all the ones at the top up a bit untill\n\t\t// they no longer overlap\n    var vCumulativeDelta = 0;\n\n\t\tfor (var j = data.length-1; j > 0; j--) {\n\t\t\tfor (var i = data.length-1; i > 0; i--) {\n        \n        vCumulativeDelta =  data[i-1].yRevBottom > data[i].yRevTop\n          ? (data[i-1].yRevBottom-data[i].yRevTop)\n          : 0;\n\n        if (vCumulativeDelta > 0) {\n          selectAll(\".rev.\" + makeClass(data[i-1]))\n          .attr(\"transform\", \"translate(\" + 0 + \",\" + (-vCumulativeDelta) + \")\")\n          \n          data[i-1].yRevBottom -= vCumulativeDelta;\n          data[i-1].yRevTop -= vCumulativeDelta;\n          break;\n        }\n\t\t\t}\n\t\t}\n\n\t\tnode.call(tooltip);\n\n\t}\n\t\n\t\n\trender() {\n\t\tlet data = this.props.data ? this.props.data : [];\n\n\t\treturn (\n\t\t\t<div className=\"MainVizComponent\">\n\t\t\t\t<svg className=\"MainChart\" ref={node => this.node = node}\n          width={this.props.width} height={this.state.height}>\n        </svg>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nMainVizComponent.propTypes = {}\n\nMainVizComponent.defaultProps = {}\n\nexport default MainVizComponent\n","export const makeTooltip = (title,items) => {\n  let htmlBlock = \"<div class='tootltip' style='font-size:12px; border: 1px solid #ccc; background-color: rgba(255,255,255,0.9); padding:5px; max-width:350px; z-index:2000'>\"\n  htmlBlock += title ? \"<div style='font-size:20px'>\" + title + \"</div>\" : '';\n  if (items)\n    items.forEach(i => {\n      htmlBlock += (\"<br/><strong>\"+i.label+\":</strong> \")\n      htmlBlock += (\"<div class='tootltip-value' style='font-size:18px;'>\"+i.value+\"</div>\")\n    })\n  htmlBlock += '</div>';\n  return htmlBlock;\n}\n\n","import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport './App.scss';\nimport 'react-widgets/dist/css/react-widgets.css';\nimport _ from 'lodash'\nimport { loadAllData } from './DataLoading';\nimport MainVizComponent from './components/MainVizComponent/MainVizComponent';\nimport {Helmet} from \"react-helmet\";\nimport Switch from \"react-switch\";\nimport { Combobox } from 'react-widgets';\n\nclass App extends Component {\n\n  constructor() {\n    super()\n    this.state = {\n      ...this.props,\n      dimensions: {\n        width: window.innerWidth,\n        height: window.innerHeight\n      },\n      data: [],\n      timeline: false,\n      revAsCircles: true\n    };\n    this.handleTimeLineChange = this.handleTimeLineChange.bind(this)\n    this.handleFilterYearChange = this.handleFilterYearChange.bind(this)\n    this.handleRevAsCirclesChange = this.handleRevAsCirclesChange.bind(this)\n    this.updateDimensions = this.updateDimensions.bind(this)\n  }\n\n  \n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.updateDimensions);\n    this.getData();\n    console.log('mounted')\n  }\n\n  updateDimensions() {\n    this.setState({\n      dimensions: {\n\t\t\t\theight: window.innerHeight, \n\t\t\t\twidth: window.innerWidth\n\t\t\t}\n    });\n  }\n\n  handleTimeLineChange(checked) {\n    this.setState({ timeline: checked });\n  }\n\n  handleRevAsCirclesChange(checked) {\n    this.setState({ revAsCircles: checked });\n  }\n  \n  handleFilterYearChange(year) {\n    console.log(year);\n    const filteredData = year === \"All\"\n      ? this.state.data\n      : this.state.data.filter(d => d.Date_of_sale.year() === +year)\n    this.setState({ filteredData });\n  }\n\n  getData() {\n    loadAllData()\n      .then(data => {\n        // set initial data\n        var years = [\"All\", ..._.uniq(data.map(d => d.Date_of_sale.year()))];\n        this.setState({ \n          data: data, \n          filteredData: data,\n          years: years\n        });\n      })\n  }\n\n\n  render() {\n    console.log(this.state.data)\n    const isLoading = !!(_.isEmpty(this.state.data)) ? true : false;\n\n    return (\n\n      \n      !!isLoading\n      ? null\n      : <div className=\"App\">\n\n        <header>\n        <div className=\"application\">\n            <Helmet>\n              <meta charSet=\"utf-8\" />\n              <meta name=\"viewport\" content=\"width=1100,initial-scale=0.3,shrink-to-fit=yes\" />\n            </Helmet>\n        </div>\n        </header>\n\n        <div className=\"uiWidgetContainer\">\n          <label>\n            <span>Revenue as Circles</span>\n            <br/>\n            <Switch onChange={this.handleRevAsCirclesChange} checked={this.state.revAsCircles} />\n          </label>\n        </div>\n        <div className=\"uiWidgetContainer\">\n          <label>\n            <span>Timeline View</span>\n            <br/>\n            <Switch onChange={this.handleTimeLineChange} checked={this.state.timeline} />\n          </label>\n        </div>\n        <div className=\"uiWidgetContainer\">\n          Filter by year:\n          <Combobox\n            data={this.state.years}\n            defaultValue={\"All\"}\n            onChange={this.handleFilterYearChange }\n          />\n        </div>\n        \n\n        <div className=\"vizContainer\">\n          <MainVizComponent\n            data = {this.state.filteredData}\n            width = {this.state.dimensions.width*.95}\n            timeline = {this.state.timeline}\n            revAsCircles = {this.state.revAsCircles}\n          />\n        </div>\n        \n      </div>\n    );\n  }\n}\n\nexport default App;\n","import { csv, json } from 'd3-fetch';\nimport { nest } from 'd3-collection';\nimport * as moment from 'moment';\n\nimport timorAll from \"./data/gnpc_commodity_exports.csv\";\n\nexport const loadAllData = () => {\n  \n  const promises = [];\n\n  promises.push(\n    csv(timorAll)\n  )\n\n  return Promise.all(promises).then(function (values) {\n    console.log(values);\n\n    const result = [];\n    values[0].forEach(d => {\n\t\t\td.Date_of_sale = moment(d.Date_of_sale, \"YYYY-MM-DD\")\n\t\t\td.Payment_receipt_date = moment(d.Payment_receipt_date, \"YYYY-MM-DD\")\n      result.push(d);  \n    })\n\n    return result;\n  })\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/gnpc_commodity_exports.97d62662.csv\";","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";"],"sourceRoot":""}