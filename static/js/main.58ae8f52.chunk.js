(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(t,e,a){t.exports=a.p+"static/media/gnpc_commodity_exports.97d62662.csv"},27:function(t,e,a){t.exports=a(37)},32:function(t,e,a){},33:function(t,e,a){t.exports=a.p+"static/media/logo.5d5d9eef.svg"},34:function(t,e,a){},35:function(t,e,a){},37:function(t,e,a){"use strict";a.r(e);var r=a(3),n=a.n(r),i=a(21),o=a.n(i),l=(a(32),a(26)),c=a(10),s=a(11),u=a(14),f=a(13),d=a(15),p=(a(33),a(34),a(8)),h=a.n(p),b=a(25),y=(a(16),a(17)),x=a(22),v=a.n(x),m=a(12),g=(a(35),a(2)),D=a(9),O=a(24),w=(a(38),a(6)),P=a(23),j=(a(1),function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(f.a)(e).call(this,t))).createChart=a.createChart.bind(Object(m.a)(a)),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this.createChart()}},{key:"componentDidUpdate",value:function(){this.createChart()}},{key:"createChart",value:function(){var t=this.props.data?this.props.data:[],e=150,a=450,r=1e3-a-5,n=4e3-e-5,i=Object(g.a)(this.node);console.log(t),t=h.a.sortBy(t,"Date_of_sale");var o=Object(w.a)(",.2f"),l=Object(D.a)().range([n,0]),c={xOffset:0,yOffset:0,width:150,height:n,labelPositioning:{alpha:.5,spacing:18},leftTitle:"Lifting",rightTitle:"Buyer & Destination",leftSubTitle:"Date of Sale",rightSubTitle:"Payment Due Date",labelGroupOffset:5,labelKeyOffset:50,radius:6,subTitleYShift:20,unfocusOpacity:.3,revWidthMultiple:3.5,priceWidthMultiple:1.5},s=50,u=10,f="#ecb600",d="#CE1126",p="#eee",b=3,y=400,x="Volume (barrels)",v="Price (US$)",m="Revenue (US$)",j=Object(P.a)().attr("class","d3-tip").offset([0,20]).direction(function(t){return"se"}).html(function(t){return function(t,e){var a="<div class='tootltip' style='font-size:12px; border: 1px solid #ccc; background-color: rgba(255,255,255,0.9); padding:5px; max-width:350px; z-index:2000'>";return a+=t?"<div style='font-size:20px'>"+t+"</div>":"",e&&e.forEach(function(t){a+="<br/><strong>"+t.label+":</strong> ",a+="<div class='tootltip-value' style='font-size:18px;'>"+t.value+"</div>"}),a+="</div>"}(t.year,[{label:"Lifting",value:t.Lifting},{label:"Date of Sale",value:t.Date_of_sale.format("D MMM YYYY")},{label:"Payment Receipt Date",value:t.Payment_receipt_date.format("D MMM YYYY")},{label:"Price",value:"US$ "+o(t.Price)+" per barrel"},{label:"Volume",value:o(t.Volume)+" barrels"},{label:"Revenue",value:"US$ "+o(t.Revenue)},{label:"Buyer",value:t.Buyer},{label:"Destination",value:t.Destination}])});i.selectAll("g").remove();Object(D.a)().range([0,r]).domain([0,86400]),Object(D.b)(O.a).domain([0,10]);l.domain([new Date(2018,3,30),new Date(2015,0,1)]);var M=i.append("g").attr("class","border-lines").attr("transform","translate("+a+","+e+")");M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",c.height),M.append("line").attr("x1",c.width).attr("y1",0).attr("x2",c.width).attr("y2",c.height);var R=i.append("g").selectAll("g").data(t).enter().append("g").attr("transform","translate("+a+","+e+")").attr("class","slope-group").attr("id",function(t,e){t.id="group"+t.Lifting,t.sellDate=t.Date_of_sale.toDate(),t.paymentDate=t.Payment_receipt_date.toDate()}),Y=(R.append("line").attr("class","slope-line").attr("x1",0).attr("y1",function(t){return console.log(t),l(t.sellDate)}).attr("x2",c.width).attr("y2",function(t){return l(t.paymentDate)}),R.append("circle").attr("r",c.radius).attr("cy",function(t){return l(t.sellDate)}),R.append("g").attr("class","slope-label-left").each(function(t){t.xLeftPosition=-c.labelGroupOffset,t.yLeftPosition=l(t.sellDate)}));Y.append("text").attr("class","label-figure-small").attr("x",function(t){return t.xLeftPosition}).attr("y",function(t){return t.yLeftPosition}).attr("dx",-10).attr("dy",c.subTitleYShift).attr("text-anchor","end").text(function(t){return t.Date_of_sale.format("D MMM YYYY")}),Y.append("text").attr("class","label-figure").attr("x",function(t){return t.xLeftPosition}).attr("y",function(t){return t.yLeftPosition}).attr("dx",-10).attr("dy",3).attr("text-anchor","end").text(function(t){return t.Lifting});R.append("circle").attr("r",c.radius).attr("cx",c.width).attr("cy",function(t){return l(t.paymentDate)});var _=R.append("g").attr("class","slope-label-right").each(function(t){t.xRightPosition=c.width+c.labelGroupOffset,t.yRightPosition=l(t.paymentDate)});_.append("text").attr("class","label-figure-small").attr("x",function(t){return t.xRightPosition}).attr("y",function(t){return t.yRightPosition}).attr("dx",10).attr("dy",c.subTitleYShift).attr("text-anchor","start").text(function(t){return t.Payment_receipt_date.format("D MMM YYYY")}),_.append("text").attr("class","label-figure").attr("x",function(t){return t.xRightPosition}).attr("y",function(t){return t.yRightPosition}).attr("dx",10).attr("dy",3).attr("text-anchor","start").text(function(t){return t.Buyer+", "+t.Destination});var k=i.append("g").attr("transform","translate(0,"+e+")").attr("class","title");k.append("text").attr("text-anchor","end").attr("x",a).attr("dx",-10).attr("dy",-e/4).text(c.leftTitle),k.append("text").attr("text-anchor","end").attr("class","label-figure-small").attr("x",a).attr("dx",-10).attr("dy",-e/4+c.subTitleYShift).text(c.leftSubTitle),k.append("text").attr("x",a+c.width).attr("dx",10).attr("dy",-e/4).text(c.rightTitle),k.append("text").attr("class","label-figure-small").attr("x",a+c.width).attr("dx",10).attr("dy",-e/4+c.subTitleYShift).text(c.rightSubTitle);var T=i.append("g").attr("transform","translate("+(a+c.width)+","+e+")").attr("class","price"),S=Object(D.a)().range([0,s]).domain([0,70]);function L(t){return t.Lifting.split(" ").join("").toLowerCase()}T.selectAll(".bar").data(t).enter().append("rect").attr("class",function(t){return"bar price "+L(t)}).attr("x",function(t){return c.width*c.priceWidthMultiple}).attr("width",function(t){return S(+t.Price)}).attr("y",function(t,e){return t.yRightPosition-u/2}).attr("fill",function(t){return f}).attr("stroke",function(t){return p}).attr("height",function(t){return u}).on("mouseover",function(t){j.show(t,this),Object(g.b)("."+L(t)).attr("fill",d),Object(g.b)(".annote."+L(t)).attr("display","block")}).on("mouseout",function(t){j.hide(),Object(g.b)("."+L(t)).attr("fill",f),Object(g.b)(".annote."+L(t)).attr("display","none")}),k.append("text").attr("text-anchor","start").attr("x",a+c.width*(c.priceWidthMultiple+1)).attr("dx",-10).attr("dy",-e/4).text(v),k.append("text").attr("text-anchor","start").attr("x",0).attr("dx",0).attr("dy",-e/4).text(x),k.append("text").attr("text-anchor","start").attr("x",a+c.width*c.revWidthMultiple).attr("dx",0).attr("dy",-e/4).text(m);var B=t.map(function(t){return h.a.range(0,Math.round(t.Volume/1e4))});console.log(B);var E=[],C=[];t.forEach(function(r,n){E.push(i.append("g").attr("transform","translate(10,"+e+")").attr("class",function(t){return"volume"})),C.push(i.append("g").attr("transform","translate("+(a+c.width*c.revWidthMultiple)+","+e+")").attr("class",function(t){return"rev"})),E[n].selectAll(".bar").data(B[n]).enter().append("rect").attr("class",function(t){return"bar vol "+L(r)}).attr("x",function(t,e){return b*e}).attr("width",function(t){return b}).attr("y",function(t,e){return r.yLeftPosition-u/2}).attr("fill",function(t){return f}).attr("stroke",function(t){return p}).attr("height",function(t){return u}).on("mouseover",function(t){j.show(r,this),Object(g.b)("."+L(r)).attr("fill",d),Object(g.b)(".annote."+L(r)).attr("display","block")}).on("mouseout",function(t){j.hide(),Object(g.b)("."+L(r)).attr("fill",f),Object(g.b)(".annote."+L(r)).attr("display","none")}),C[n].selectAll(".bar").data(B[n]).enter().append("rect").attr("class",function(t){return"bar rev "+L(r)}).attr("x",function(t,e){var a=S(+r.Price);return e%Math.floor(y/a)*a}).attr("width",function(t){return S(+r.Price)}).attr("y",function(e,a){var i=S(+r.Price),o=Math.floor(y/i),l=Math.floor(a/o),c=r.yRightPosition-u/2+u*l;return t[n].yRevBottom=t[n].yRevBottom>c+u?t[n].yRevBottom:c+u,c}).attr("fill",function(t){return f}).attr("stroke",function(t){return p}).attr("height",function(t){return u}).on("mouseover",function(t){j.show(r,this),Object(g.b)("."+L(r)).attr("fill",d),Object(g.b)(".annote."+L(r)).attr("display","block")}).on("mouseout",function(t){j.hide(),Object(g.b)("."+L(r)).attr("fill",f),Object(g.b)(".annote."+L(r)).attr("display","none")}),i.append("g").attr("transform","translate(0,"+e+")").append("text").attr("text-anchor","left").attr("class",function(t){return"annote vol "+L(r)}).attr("x",10).attr("dx",0).attr("y",r.yLeftPosition-10).attr("fill",f).attr("display","none").text(o(r.Volume)+" barrels"),i.append("g").attr("transform","translate(0,"+e+")").append("text").attr("text-anchor","middle").attr("class",function(t){return"annote price "+L(r)}).attr("x",a+c.width*(c.priceWidthMultiple+1.25)).attr("dx",0).attr("y",r.yRightPosition).attr("dy",-10).attr("fill",f).attr("display","none").text("US$ "+o(r.Price)+" per barrel"),i.append("g").attr("transform","translate(0,"+e+")").append("text").attr("text-anchor","left").attr("class",function(t){return"annote rev "+L(r)}).attr("x",a+c.width*(c.revWidthMultiple+.5)).attr("dx",0).attr("y",function(e){return t[n].yRevTop=r.yRightPosition-10,r.yRightPosition-10}).attr("fill",f).attr("display","none").text("US$ "+o(r.Revenue)+" in revenue ")}),console.log(t);for(var W=0,A=t.length-1;A>0;A--)for(var U=t.length-1;U>0;U--)if(console.log(t[U].Lifting,t[U].yRevTop,t[U-1].Lifting,t[U-1].yRevBottom,t[U].yRevTop-t[U-1].yRevBottom),(W=t[U-1].yRevBottom>t[U].yRevTop?t[U-1].yRevBottom-t[U].yRevTop:0)>0){Object(g.b)(".rev."+L(t[U-1])).attr("transform","translate(0,"+-W+")"),t[U-1].yRevBottom-=W,t[U-1].yRevTop-=W;break}i.call(j)}},{key:"render",value:function(){var t=this,e=this.props.data?this.props.data:[];return n.a.createElement("div",{className:"MainVizComponent"},n.a.createElement("svg",{className:"MainChart",ref:function(e){return t.node=e},width:1500,height:200*e.length}))}}]),e}(r.Component));j.defaultProps={};var M=j,R=function(t){function e(){var t,a;Object(c.a)(this,e);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(u.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(n)))).state=Object(l.a)({},a.props,{data:[]}),a}return Object(d.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){console.log("mounted"),this.getData()}},{key:"getData",value:function(){var t=this;(function(){var t=[];return t.push(Object(b.a)(v.a)),Promise.all(t).then(function(t){console.log(t);var e=[];return t[0].forEach(function(t){t.Date_of_sale=y(t.Date_of_sale,"YYYY-MM-DD"),t.Payment_receipt_date=y(t.Payment_receipt_date,"YYYY-MM-DD"),e.push(t)}),e})})().then(function(e){t.setState({data:e})})}},{key:"render",value:function(){return console.log(this.state.data),!!h.a.isEmpty(this.state.data)?null:n.a.createElement("div",{className:"App"},n.a.createElement("header",null),n.a.createElement("div",{className:"vizContainer"},n.a.createElement(M,{data:this.state.data})))}}]),e}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.58ae8f52.chunk.js.map