{"version":3,"sources":["data/gnpc_commodity_exports.csv","logo.svg","components/MainVizComponent/MainVizComponent.js","VizHelpers.js","App.js","DataLoading.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","MainVizComponent","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","createChart","bind","assertThisInitialized","data","margin","width","height","node","select","console","log","_","sortBy","numFormat","format","y1","scaleLinear","range","config","xOffset","yOffset","labelPositioning","alpha","spacing","leftTitle","rightTitle","leftSubTitle","rightSubTitle","labelGroupOffset","labelKeyOffset","radius","subTitleYShift","unfocusOpacity","revWidthMultiple","priceWidthMultiple","smallConfig","tooltip","tip","attr","offset","direction","d","html","title","items","htmlBlock","forEach","i","label","value","makeTooltip","year","Lifting","Date_of_sale","Payment_receipt_date","Price","Volume","Revenue","Buyer","Destination","selectAll","remove","domain","scaleSequential","interpolateReds","Date","borderLines","append","slopeGroups","enter","id","sellDate","toDate","paymentDate","leftSlopeLabels","each","xLeftPosition","yLeftPosition","text","rightSlopeLabels","xRightPosition","yRightPosition","titles","priceBars","smallX","makeClass","split","join","toLowerCase","on","show","hide","volData","map","Math","round","volBars","revBars","currentBatch","push","j","boxWidth","floor","boxesPerRow","row","returnVal","yRevBottom","yRevTop","vCumulativeDelta","length","_this2","react_default","a","createElement","className","ref","Component","defaultProps","App","state","getData","promises","csv","timorAll","Promise","all","then","values","result","moment","loadAllData","setState","isEmpty","components_MainVizComponent_MainVizComponent","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.58ae8f52.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/gnpc_commodity_exports.97d62662.csv\";","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport styles from './MainVizComponent.scss'\nimport _ from 'lodash'\nimport { select, selectAll } from 'd3-selection'\nimport { scaleBand,scaleLinear,scaleQuantile,scaleSequential } from 'd3-scale'\nimport { interpolateReds } from 'd3-scale-chromatic'\nimport { axisBottom, axisLeft } from 'd3-axis'\nimport { format } from 'd3-format'\nimport { default as tip } from 'd3-tip'\nimport { min, max } from 'd3-array'\nimport { makeTooltip } from '../../VizHelpers'\n\n\nclass MainVizComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.createChart = this.createChart.bind(this)\n\t}\n\tcomponentDidMount() {\n\t\tthis.createChart()\n\t}\n\t\n\tcomponentDidUpdate() {\n\t\tthis.createChart()\n\t}\n\n\tcreateChart() {\n\t\tlet data = this.props.data ? this.props.data : [];\n\t\tvar margin = {top: 150, right: 5, bottom: 5, left: 450},\n\t\twidth = 1000 - margin.left - margin.right,\n\t\theight = 4000 - margin.top - margin.bottom,\n\t\tnode = select(this.node);\n\n\t\tconsole.log(data);\n\n\t\tdata = _.sortBy(data,\"Date_of_sale\")\n\t\t// const barHeight = 5;\n\n\t\t// var durationFormat = format(\".1f\");\n\t\tvar numFormat = format(',.2f');\n\n\t\tvar y1 = scaleLinear()\n    \t.range([height, 0]);\n\n\t\tvar config = {\n      xOffset: 0,\n      yOffset: 0,\n      width: 150,\n      height: height,\n      labelPositioning: {\n        alpha: 0.5,\n        spacing: 18\n      },\n      leftTitle: \"Lifting\",\n      rightTitle: \"Buyer & Destination\",\n      leftSubTitle: \"Date of Sale\",\n      rightSubTitle: \"Payment Due Date\",\n      labelGroupOffset: 5,\n      labelKeyOffset: 50,\n\t\t\tradius: 6,\n\t\t\tsubTitleYShift: 20,\n      // Reduce this to turn on detail-on-hover version\n\t\t\tunfocusOpacity: 0.3,\n\t\t\trevWidthMultiple: 3.5,\n\t\t\tpriceWidthMultiple: 1.5\n\t\t}\n\t\t\n\t\tvar smallConfig = {\n\t\t\tmaxwidth: 50,\n\t\t\theight: 10,\n\t\t\t// color: '#c59800',\n\t\t\tcolor: '#ecb600',\n\t\t\thighlightColor: '#CE1126',\n\t\t\tborder: '#eee',\n\t\t\tvolWidth: 3,\n\t\t\tmaxRevWidth: 400,\n\t\t\tvolTitle: \"Volume (barrels)\",\n\t\t\tpriceTitle: \"Price (US$)\",\n\t\t\trevTitle: \"Revenue (US$)\",\n\t\t}\n\n\t\tlet tooltip = tip()\n\t\t\t.attr('class', 'd3-tip')\n\t\t\t.offset([0, 20])\n\t\t\t.direction(d => 'se')\n\t\t\t.html((d) => {\n\t\t\t\treturn makeTooltip(\n\t\t\t\t\td.year,\n\t\t\t\t\t[\n\t\t\t\t\t\t{label:\"Lifting\", value:d.Lifting},\n\t\t\t\t\t\t{label:\"Date of Sale\", value:d.Date_of_sale.format(\"D MMM YYYY\")},\n\t\t\t\t\t\t{label:\"Payment Receipt Date\", value:d.Payment_receipt_date.format(\"D MMM YYYY\")},\n\t\t\t\t\t\t{label:\"Price\", value:\"US$ \"+numFormat(d.Price)+\" per barrel\"},\n\t\t\t\t\t\t{label:\"Volume\", value:numFormat(d.Volume)+\" barrels\"},\n\t\t\t\t\t\t{label:\"Revenue\", value:\"US$ \"+numFormat(d.Revenue)},\n\t\t\t\t\t\t{label:\"Buyer\", value:d.Buyer},\n\t\t\t\t\t\t{label:\"Destination\", value:d.Destination}\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t})\n\n\t\tnode.selectAll(\"g\").remove();\n\t\t// set the ranges\n\t\t// var x = scaleBand()\n\t\t//   .range([0, width])\n\t\t//   .domain([2013,2014,2015,2016,2017,2018])\n\t\t//   .padding(0.1);\n\t\tvar x = scaleLinear()\n\t\t\t.range([0, width])\n\t\t\t// .domain([0,_.max(this.props.maxDuration)]);\n\t\t\t// .domain([0,_.max(durations)]); \n\t\t\t.domain([0,3600*24.0]); \n\n\t\tvar colorScale = scaleSequential(interpolateReds)\n\t\t// .domain([0,_.max(cpues)])\n\t\t.domain([0,10])\n\t\t// .domain([0,5,10,15,20,25,30,35,40])\n\t\t// .range(schemeBlues);\n\n\t\tvar getColor = function(cpue) {\n\t\t\tif (cpue) {\n\t\t\t\treturn colorScale(cpue);\n\t\t\t} else return \"#ccc\";\n\t\t}\n\n\t\t\t \n\t\t// Calculate y domain for ratios\n\t\ty1.domain([new Date(2018, 3, 30), new Date(2015, 0, 1)]);\n\t\t\n\t\tvar yScale = y1;\n\t\t\t\t\n\t\tvar borderLines = node.append(\"g\")\n\t\t\t\t.attr(\"class\", \"border-lines\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\t\tborderLines.append(\"line\")\n\t\t\t.attr(\"x1\", 0).attr(\"y1\", 0)\n\t\t\t.attr(\"x2\", 0).attr(\"y2\", config.height);\n\t\tborderLines.append(\"line\")\n\t\t\t.attr(\"x1\", config.width ).attr(\"y1\", 0)\n\t\t\t.attr(\"x2\", config.width ).attr(\"y2\", config.height);\n\t\t\n\t\tvar slopeGroups = node.append(\"g\")\n\t\t\t.selectAll(\"g\")\n\t\t\t.data(data)\n\t\t\t.enter().append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", \"slope-group\")\n\t\t\t\t.attr(\"id\", function(d, i) {\n\t\t\t\t\td.id = \"group\" + d.Lifting;\n\t\t\t\t\td.sellDate = d.Date_of_sale.toDate();\n\t\t\t\t\td.paymentDate = d.Payment_receipt_date.toDate();\n\t\t\t\t});\n\t\t\n\t\tvar slopeLines = slopeGroups.append(\"line\")\n\t\t\t.attr(\"class\", \"slope-line\")\n\t\t\t.attr(\"x1\", 0)\n\t\t\t.attr(\"y1\", function(d) {\n\t\t\t\tconsole.log(d);\n\t\t\t\treturn y1(d.sellDate);\n\t\t\t})\n\t\t\t.attr(\"x2\", config.width)\n\t\t\t.attr(\"y2\", function(d) {\n\t\t\t\treturn y1(d.paymentDate);\n\t\t\t});\n\t\t\n\t\tvar leftSlopeCircle = slopeGroups.append(\"circle\")\n\t\t\t.attr(\"r\", config.radius)\n\t\t\t.attr(\"cy\", d => y1(d.sellDate));\n\t\t\n\t\tvar leftSlopeLabels = slopeGroups.append(\"g\")\n\t\t\t.attr(\"class\", \"slope-label-left\")\n\t\t\t.each(function(d) {\n\t\t\t\td.xLeftPosition = -config.labelGroupOffset;\n\t\t\t\td.yLeftPosition = y1(d.sellDate);\n\t\t\t});\n\t\t\n\t\tleftSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", d => d.xLeftPosition)\n\t\t\t.attr(\"y\", d => d.yLeftPosition)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.text(d => (d.Date_of_sale.format(\"D MMM YYYY\")));\n\t\t\n\t\tleftSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xLeftPosition)\n\t\t\t.attr(\"y\", d => d.yLeftPosition)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", 3)\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.text(d => d.Lifting);\n\t\t\n\t\tvar rightSlopeCircle = slopeGroups.append(\"circle\")\n\t\t\t.attr(\"r\", config.radius)\n\t\t\t.attr(\"cx\", config.width)\n\t\t\t.attr(\"cy\", d => y1(d.paymentDate));\n\t\t\n\t\tvar rightSlopeLabels = slopeGroups.append(\"g\")\n\t\t\t.attr(\"class\", \"slope-label-right\")\n\t\t\t.each(function(d) {\n\t\t\t\td.xRightPosition = config.width + config.labelGroupOffset;\n\t\t\t\td.yRightPosition = y1(d.paymentDate);\n\t\t\t});\n\t\t\n\t\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.text(d => (d.Payment_receipt_date.format(\"D MMM YYYY\")));\n\t\t\n\t\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 3)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.text(d => d.Buyer +\", \" +d.Destination);\n      \n\t\tvar titles = node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", \"title\");\n      \n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"x\", margin.left)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(config.leftTitle);\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", margin.left)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t\t.text(config.leftSubTitle);\n\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"x\", margin.left + config.width)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(config.rightTitle);\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", margin.left + config.width)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t\t.text(config.rightSubTitle);\n\n\n\n\t\tvar priceBars = node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width) + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", \"price\");\n\n\t\tvar smallX = scaleLinear()\n\t\t\t.range([0, smallConfig.maxwidth])\n\t\t\t.domain([0,70]); \n\n\t\tfunction makeClass(d) {\n\t\t\treturn d.Lifting.split(\" \").join(\"\").toLowerCase();\n\t\t} \n\n\t\tpriceBars.selectAll(\".bar\")\n      .data(data)\n    .enter().append(\"rect\")\n      .attr(\"class\", function(d) { return \"bar price \" + makeClass(d);})\n      .attr(\"x\", function(d) { return config.width*config.priceWidthMultiple; })\n      .attr(\"width\", function(d) { return smallX(+d.Price) })\n      .attr(\"y\", function(d,i) { return d.yRightPosition - smallConfig.height/2; })\n      .attr(\"fill\", function(d) { return smallConfig.color; })\n      .attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t.on('mouseover', function(d) {\n        tooltip.show(d,this);\n        selectAll(\".\"+makeClass(d))\n\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\t\n\t\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t})\n\t\t\t.on('mouseout', function(d) {\n        tooltip.hide();\n        selectAll(\".\"+makeClass(d))\n\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\t\n\t\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t\t.attr(\"display\", \"none\")\n      })\n\t\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1))\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.priceTitle);\n\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"dx\", 0)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.volTitle);\n\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.revWidthMultiple)\n\t\t\t.attr(\"dx\", 0)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.revTitle);\n\n\t\tvar volData = data.map(function(d) {\n\t\t\treturn _.range(0,Math.round(d.Volume/10000))\n\t\t})\n\n\n\t\tconsole.log(volData);\n\n\t\tvar volBars = [];\n\t\tvar revBars = [];\n\t\tvar annotations = [];\n\n\t\tdata.forEach(function(currentBatch,i) {\n\t\t\tvolBars.push(node.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 10 + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", function(d) { return \"volume\";}))\n\n\t\t\trevBars.push(node.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width*config.revWidthMultiple) + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", function(d) { return \"rev\";}));\n\n\t\t\t// console.log(volBars);\n\n\t\t\tvolBars[i].selectAll(\".bar\")\n\t\t\t\t.data(volData[i])\n\t\t\t.enter().append(\"rect\")\n\t\t\t.attr(\"class\", function(d) { return \"bar vol \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", function(d,j) { return smallConfig.volWidth*j; })\n\t\t\t\t.attr(\"width\", function(d) { return smallConfig.volWidth })\n\t\t\t\t.attr(\"y\", function(d,j) { return currentBatch.yLeftPosition - smallConfig.height/2; })\n\t\t\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\ttooltip.show(currentBatch,this);\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\t\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function(d) {\n\t\t\t\t\ttooltip.hide();\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\t\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t})\n\n\t\t\trevBars[i].selectAll(\".bar\")\n\t\t\t\t.data(volData[i])\n\t\t\t.enter().append(\"rect\")\n\t\t\t\t.attr(\"class\", function(d) { return \"bar rev \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", function(d,j) { \n\t\t\t\t\tvar boxWidth = smallX(+currentBatch.Price)\n\t\t\t\t\tvar boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n\t\t\t\t\tvar index = j % boxesPerRow;\n\t\t\t\t\treturn index*boxWidth;\n\t\t\t\t})\n\t\t\t\t.attr(\"width\", function(d) { return smallX(+currentBatch.Price) })\n\t\t\t\t.attr(\"y\", function(d,j) { \n\t\t\t\t\tvar boxWidth = smallX(+currentBatch.Price)\n\t\t\t\t\tvar boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n\t\t\t\t\tvar row = Math.floor(j/boxesPerRow);\n\n\t\t\t\t\tvar returnVal = currentBatch.yRightPosition - smallConfig.height/2 + (smallConfig.height*row);\n\t\t\t\t\tdata[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height \n\t\t\t\t\t\t? data[i].yRevBottom\n\t\t\t\t\t\t: returnVal + smallConfig.height;\n\t\t\t\t\t\n\t\t\t\t\treturn returnVal; \n\t\t\t\t})\n\t\t\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\ttooltip.show(currentBatch,this);\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function(d) {\n\t\t\t\t\ttooltip.hide();\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t})\n\n\t\t\t// Volume Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"left\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote vol \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", 10)\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t.attr(\"y\", currentBatch.yLeftPosition - 10)\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(numFormat(currentBatch.Volume)+\" barrels\")\n\n\t\t\t// Price Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote price \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1.25))\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t.attr(\"y\", currentBatch.yRightPosition)\n\t\t\t\t.attr(\"dy\", -10)\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(\"US$ \"+numFormat(currentBatch.Price)+\" per barrel\")\n\n\t\t\t// Revenue Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"left\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote rev \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", margin.left + config.width*(config.revWidthMultiple+.5))\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t// .attr(\"y\", currentBatch.yRightPosition - 10)\n\t\t\t\t.attr(\"y\", function(d) { \n\t\t\t\t\tdata[i].yRevTop = currentBatch.yRightPosition - 10;\n\t\t\t\t\treturn currentBatch.yRightPosition-10;\n\t\t\t\t})\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(\"US$ \"+numFormat(currentBatch.Revenue) + \" in revenue \") \n\t\t\t\t\t// + numFormat(data[i].yRevTop) + \" \" + numFormat(data[i].yRevBottom) )\n\t\t\t\n\t\t})\n\n\t\tconsole.log(data);\n\n\t\t// Adjust Rev Blocks so they don't overlap\n\t\t// Start from the bottom and keep pushing all the ones at the top up a bit untill\n\t\t// they no longer overlap\n\t\tvar vCumulativeDelta = 0;\n\t\tfor (var j = data.length-1; j > 0; j--) {\n\t\t\tfor (var i = data.length-1; i > 0; i--) {\n        console.log(data[i].Lifting,\n          data[i].yRevTop,\n          data[i-1].Lifting,\n          data[i-1].yRevBottom,\n          data[i].yRevTop-data[i-1].yRevBottom);\n        \n        vCumulativeDelta =  data[i-1].yRevBottom > data[i].yRevTop\n          ? (data[i-1].yRevBottom-data[i].yRevTop)\n          : 0;\n\n        if (vCumulativeDelta > 0) {\n          selectAll(\".rev.\" + makeClass(data[i-1]))\n          .attr(\"transform\", \"translate(\" + 0 + \",\" + (-vCumulativeDelta) + \")\")\n          // .attr(\"dy\", vCumulativeDelta);\n          \n          data[i-1].yRevBottom -= vCumulativeDelta;\n          data[i-1].yRevTop -= vCumulativeDelta;\n          break;\n        }\n\t\t\t}\n\t\t}\n\n\t\tnode.call(tooltip);\n\n\t}\n\t\n\t\n\trender() {\n\t\tlet data = this.props.data ? this.props.data : [];\n\n\t\treturn (\n\t\t\t<div className=\"MainVizComponent\">\n\t\t\t\t<svg className=\"MainChart\" ref={node => this.node = node}\n          width={1500} height={data.length*200}>\n        </svg>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nMainVizComponent.propTypes = {}\n\nMainVizComponent.defaultProps = {}\n\nexport default MainVizComponent\n","export const makeTooltip = (title,items) => {\n  let htmlBlock = \"<div class='tootltip' style='font-size:12px; border: 1px solid #ccc; background-color: rgba(255,255,255,0.9); padding:5px; max-width:350px; z-index:2000'>\"\n  htmlBlock += title ? \"<div style='font-size:20px'>\" + title + \"</div>\" : '';\n  if (items)\n    items.forEach(i => {\n      htmlBlock += (\"<br/><strong>\"+i.label+\":</strong> \")\n      htmlBlock += (\"<div class='tootltip-value' style='font-size:18px;'>\"+i.value+\"</div>\")\n    })\n  htmlBlock += '</div>';\n  return htmlBlock;\n}\n\n","import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport _ from 'lodash'\nimport { loadAllData } from './DataLoading';\nimport MainVizComponent from './components/MainVizComponent/MainVizComponent';\n\nclass App extends Component {\n\n  state = {\n    ...this.props,\n    data: []\n  }\n\n  componentDidMount() {\n    console.log('mounted')\n    this.getData();\n  }\n  \n  getData() {\n    loadAllData()\n      .then(data => {\n        // set initial data\n        this.setState({ data });\n      })\n  }\n\n\n  render() {\n    console.log(this.state.data)\n    const isLoading = !!(_.isEmpty(this.state.data)) ? true : false;\n\n    return (\n      !!isLoading\n      ? null\n      : <div className=\"App\">\n        <header>\n        </header>\n        <div className=\"vizContainer\">\n          <MainVizComponent\n            data = {this.state.data}\n          />\n        </div>\n        \n      </div>\n    );\n  }\n}\n\nexport default App;\n","import { csv, json } from 'd3-fetch';\nimport { nest } from 'd3-collection';\nimport * as moment from 'moment';\n\nimport timorAll from \"./data/gnpc_commodity_exports.csv\";\n\nexport const loadAllData = () => {\n  \n  const promises = [];\n\n  promises.push(\n    csv(timorAll)\n  )\n\n  return Promise.all(promises).then(function (values) {\n    console.log(values);\n\n    const result = [];\n    values[0].forEach(d => {\n\t\t\td.Date_of_sale = moment(d.Date_of_sale, \"YYYY-MM-DD\")\n\t\t\td.Payment_receipt_date = moment(d.Payment_receipt_date, \"YYYY-MM-DD\")\n      result.push(d);  \n    })\n\n    return result;\n  })\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}